to understand how the bullet environment moves as I move the joints and use this to be able to understand how to define states and rewards in the final enviornment for RL


test 1
moving the stand by 180 degree and seeing how each element in p.getLinkstate behaves

p.setJointMotorControlArray(env, [0],p.POSITION_CONTROL, targetPositions= [-3.14])    

observing p.getLinkState(env,0)[0]  (linkWorldPosition ,vec3, list of 3 floats , Cartesian position of center of mass )
result: no change in the value

observing p.getLinkState(env,0)[1]  (linkWorldOrientation,
vec4, list of 4 floats,
Cartesian orientation of center of mass, in quaternion [x,y,z,w])
result : the quaternions x and y changed so i converted to euler which gave me (3.14159265358978, 9.057052533490636e-15, 0.23406194496518992)
this clearly says that 0.23406 is how much the bot is rotated by initially along the z axis which when quickly corrected to 0 perfectly sets the bot aligned exactly to the grid on the plane... now this makes it easy to define states.



experiment next 
p.setJointMotorControlArray(env, [0],
                                 p.POSITION_CONTROL, targetPositions= [+3.14]
                            
                                    )

when moved by 180 degrees the euler after significant time steps goes from (3.14159265358978, 9.057052533490636e-15, 0.0) to (-3.14159265358978, -9.078622618645096e-15, -3.139987481687532) which suggests that the most important coordinate in this euler is the z coordinate (obviously) using this we can define thr rotation of the base and move on from there. notivce how the z change from 0 to -3.14 for 



test 2
moving the slider joint
p.setJointMotorControlArray(env, [1],
                                 p.POSITION_CONTROL, targetPositions= [+0.23]
                            
                                    )
we will observe the same quaterninan to euler thing and see how that moves...according to me the z value must decrease.
result 

I am suprised by how wrong i am cuz i forgot quaternians are for rotation and not for up and down motion so we may need to look at the first element in the vector by p.getlinkstate

observing p.getLinkState(env,1)[0] 
result : as expected the value of this element goes from(4.923935926002055e-15, -0.16904704893735673, 0.32659999999973116) to (8.111614566551316e-13, -0.16904704893735983, 0.09669455261257351) Notice the difference between z1 and z2 it is exactly 0.23 ehich is exactly our input

this tell me that for slider the important value is the z coordinate of the cartesion position of the center of mass


test 3
p.setJointMotorControlArray(env, [2],
                                 p.POSITION_CONTROL, targetPositions= [-1.5261]
                            
                                    )
gripper 
This is fairly staraight forward we just need to consider the z coordinate of the quaternion to euler. 
There is something interesting that has happened that has to be looked into.
from the starting position everything is calculate.....impotant
that means if for the gripper the starting position of angle along the y axis is -1.57 rad then the limit is calculated on that value that make it relative. Thats why the initial value from onshape matters a .

This means when i ran my experiment i found out that the value for the above element went from (-1.570796326794906, -0.32023091631508604, -1.5707963267948937) to (-1.57079632679491, -0.8438099149622986, -1.570796326787648) clearly u can see that the value of the y coordinate goes from -0.32 to -0.84 and the max limit is -0.52 from the starting point now what we need to do is to be able to understand why for inputting -ve value this has rotated in the -ve direction but in case of the stand it isexactly opposite 

test 4
gripper 2
literarly the same obsservation 



what is interesting that i found in pybullet is that if you set the targetposition of the base to -1.57 radians then the bot rotates by 90 degree but if u set another 150 steps for -1.57 radian then the bot dosent move it stays the same .

another similar experiment suggests that if i move my bot by 90 degrees and set the targetposition to be -1.57 radians and in the next set of time steps set my targetposition to be +1.57 radians then in the next set of timesteps the bot moves by 180 degrees.

**so all the motions are relative to the initial position of the bot**

so by this logic the idea of talking the current position of the bot is completely useless because like doing "current_pos" -/+ how much u wwant to move is useless. that is because lets say for the slider jhoint the current value is -0.32 and you do -0.32 + 0.21 (that means u want to go down (as the axes points downwards) ) is expected to take u down by 0.21 which woks well but now what...the current position is 0.11 which means if we want to go up by 0.21 (which sould take us back to the start (i.e 0.32)) we must be able just do the same as before 0.11 + 0.21 = 0.32 but haha that dosent work at all. it will stll calculate based on the origin of the joint so now it will move to + 0.32 whihc means it will move down again to to its lower limit which is 0.09 and if u do 0.11 - 0.21 that means it ill move up by 0.10 will get you to 0.43...

so the work around is to shift the origin of the joint which means to do "the starting posiion of the joint - current position " using this we can now simply plug in the values wrt the inertial frame. that means for a joint that has an inintal pos of 0.32 we get he value from above and in the joint control we simply mention "the above caluclate value" - "where u want to go wrt the joint" (for our case for the first time starting from the joint ands moving up will simply be 0-0.21    now for the next iteration out new calculate value will be 0.32-o.53=-0.21 and if we wish to move down now are new input will be -0.21+0.21 which brings us exacylt to 0.32(wrt the world) this brings us to the joint pos itslef )



I though there imight be an error issue as due to internal friction the position ofg the links chage by a bit, they dont go to the exact position they were supposed to. So i though I MIGHT NEED TO MOVE BY THAT MUCH BUt the error is neglegible.







###############################################################
I am mentioning my notes here so i can remember and rewrite in the readme.MD file.

Link the onshape bot : https://cad.onshape.com/documents/04a8f06c4e82eef0aab52342/w/e26ea93d189b4fb4644d2868/e/ce0ae9d693e713171509edc4?renderMode=0&leftPanel=false&uiState=65b6963083efbe35d664705e

so basically there is something important to note here. I have redisigned the bot such that the trunk of the robot is the base of the bot.

An important thing in this case is to note that each link has an id like each joint has but pybullet has no option to get link info. So there is no way to get id corresponding to each link, according to forums and my personal experimentation pybullet assigns the same id the joint and the link which is mentiond in the joint. So I had to accordingly redisign the bot. Below is the corresponding joint and link as gotten from uising p.getJointInfo on all the joints.

(0, b'base', 0, 7, 6, 1, 0.0, 0.0, 0.0, -1.0, 1.0, 20.0, b'stand', (0.0, 0.0, 1.0), (1.3322676295501878e-15, 7.771561172376096e-16, 0.012700000000000045), (0.9931596883066847, 0.11676400782162658, -3.7125954625612054e-15, -7.205354886622792e-15), -1)

(1, b'slider', 1, 8, 7, 1, 0.0, 0.0, -0.21, 0.23, 1.0, 20.0, b'clipper_comp', (0.0, 0.0, 1.0), (0.08000000000000114, 9.594000884504565e-17, -0.050896673185445857), (-7.3196384657274e-18, 1.3341256588458525e-17, -1.9818771393416217e-15, 1.0), 0)


(2, b'gripper_front', 0, 9, 8, 1, 0.0, 0.0, -0.5235987755982988, 0.2617993877991494, 1.0, 20.0, b'gripper', (0.0, 0.0, 1.0), (0.06250000000000003, 0.13095295106263927, -6.418476861114186e-17), (-0.3535533905932758, -0.6123724356957935, -0.3535533905932733, 0.6123724356957947), 1)

(3, b'gripper_2', 0, 10, 9, 1, 0.0, 0.0, -0.5235987755982988, 0.2617993877991494, 1.0, 20.0, b'gripper_2', (0.0, 0.0, 1.0), (-0.06250000000000003, 0.08095295106263956, -8.673617379884035e-18), (-0.5733205356021042, 0.41388834660680707, 0.5733205356021052, 0.41388834660680557), 1)

fro this we can clearly infer that 
Joint 0 - is a revolute joint 
        - 'stand' is the corresponding link
        - image of the stand is shown in the above image

Joint 1 - is a slider joint that joints the stand with the clipper_comp.
        - clipper comp is a compositie part that has two hand bot can slide on the stand and thus move up and 
        down. This is the correspondiong lin
        - image is attached 
        
Joint 2 - is a revolute joint
        - it connects the front gripper to the clipper_comp
        - 'The gripper at the front is the corresponding link'

Joint 3 - is a revolute joint
        - it connects the back gripper to the clipper_comp
        - 'The gripper at the back is the corresponding link'

This completes the fist major part of the project and now it is time to test in simulation and see how these joints move the notes i will continue to write as I go ahead